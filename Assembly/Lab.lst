Microsoft (R) Macro Assembler Version 14.29.30133.0	    12/07/21 11:38:58
Lab.asm							     Page 1 - 1



				.MODEL FLAT,stdcall

				; В массиве найти два элемента, разность значений которых минимальна.

				.LIST
				  
 00000000			.DATA
					;x		dd		2, 1, 2, 4, 2, 5, 1, 7, 3, 9
 00000000 00000001			x		dd		1, 2, 3
	   00000002
	   00000003
 0000000C 000000E4			y		dd		228, 3, 8, 5
	   00000003
	   00000008
	   00000005
					;nx		dd		10
 0000001C 00000003			nx		dd		3
 00000020 00000004			ny		dd		4
 00000024 00000000			el1X    dd      0
 00000028 00000000			el1Y    dd      0
 0000002C 00000000			el2X    dd      0
 00000030 00000000			el2Y    dd      0
 00000034 00000000			counter dd		0

 00000000			.DATA?
 00000000 00000000			difX     dd     ?
 00000004 00000000			difY     dd     ?
					

 00000000			.CODE 
 00000000			lab3:

 00000000  FF 35 00000000 R		push difX
 00000006  FF 35 0000002C R		push el2X
 0000000C  FF 35 00000024 R		push el1X
 00000012  FF 35 0000001C R		push nx
 00000018  68 00000000 R		push offset x
 0000001D  E8 0000000B			call func

 00000022  A1 00000024 R		mov eax, el1X
 00000027  A1 0000002C R		mov eax, el2X

 0000002C  C3				ret

 0000002D			func proc
					; x/y = [ebp+8]
					; nx/ny = [ebp+12]
					; el1 = [ebp+16]
					; el2 = [ebp+20]
					; difX/difY = [ebp+24]

 0000002D  55				push ebp
 0000002E  8B EC			mov ebp, esp
 00000030  50				push  eax			; сохраняем используемые регистры
 00000031  53				push  ebx
 00000032  51				push  ecx
 00000033  57				push  edi
 00000034  56				push  esi

 00000035  BE 00000000			mov esi, 0			; флаг того, что минимальная разность была подсчитана
 0000003A  8B 7D 08			mov edi, [ebp+8]
 0000003D  8B 45 0C			mov eax, [ebp+12]
 00000040  A3 00000034 R		mov counter, eax
 00000045			c1:						; сравнение элемента массива с остальными элементами
 00000045  83 3D 00000034 R		cmp counter, 0
	   00
 0000004C  74 3E			je c4
 0000004E  8B 07			mov eax, [edi]

 00000050  8B 4D 0C			mov ecx, [ebp+12]	; кол-во повторений
 00000053  8B 5D 08			mov ebx, [ebp+8]	; ссылка на итерируемый элемент массива

 00000056			c2:						; поиск минимальной разницы
 00000056  3B DF			cmp ebx, edi		; проверяем, сравнивается ли элемент сам с собой
 00000058  74 22			je c3

 0000005A  8B 07			mov eax, [edi]
 0000005C  2B 03			sub eax, [ebx]
 0000005E  83 FE 00			cmp esi, 0
 00000061  75 07			jne m1
 00000063  BE 00000001			mov esi, 1
 00000068  EB 05			jmp m2
 0000006A			m1:
 0000006A  3B 45 18			cmp eax, [ebp+24]
 0000006D  7F 0D			jg c3
 0000006F			m2:
 0000006F  89 45 18			mov [ebp+24], eax	; difX/difY = eax
 00000072  8B 07			mov eax, [edi]
 00000074  89 45 10			mov [ebp+16], eax	; el1 = [edi]
 00000077  8B 03			mov eax, [ebx]
 00000079  89 45 14			mov [ebp+20], eax	; el2 = [ebx]
 0000007C			c3:
 0000007C  83 C3 04			add ebx, 4
 0000007F  E2 D5			loop c2
 00000081  83 C7 04			add edi, 4
 00000084  FF 0D 00000034 R		dec counter
 0000008A  EB B9			jmp c1
 0000008C			c4:

 0000008C  8B 45 18			mov eax, [ebp+24] ;dif
 0000008F  8B 45 10			mov eax, [ebp+16] ;el1
 00000092  8B 45 14			mov eax, [ebp+20] ;el2

 00000095  A1 00000024 R		mov eax, el1X
 0000009A  A1 0000002C R		mov eax, el2X
 0000009F  A1 00000000 R		mov eax, difX

 000000A4  5E				pop   esi			; восстанавливаем используемые регистры
 000000A5  5F				pop   edi
 000000A6  59				pop   ecx
 000000A7  5B				pop   ebx
 000000A8  58				pop   eax
 000000A9  5D				pop   ebp
 000000AA  C2 0014			ret 20
 000000AD			func endp

				end	lab3  
